---
title: Gatsbyで数種類のMarkdownを階層で使い分ける
date: 2022-03-10T00:19:43+09:00
description: frontmatterの構造が違うmarkdownを一緒のクエリの結果に含めたくなく、クエリの条件かそれ以前の仕組みで分割したかった。
url: /blog/2022-03-09-gatsbyで数種類のmarkdownを階層で使い分ける/
tags:
  - Gatsby
  - React
---	

Gatsby.js[^ver]でmarkdownをブログ以外のページのために使用したかった。
ただ、markdownのfrontmatterの部分の構造が違うので一緒のクエリの結果に含めたくなく[^deny]、クエリの条件かそれ以前の仕組みで分割したかった。
blogsフォルダに分けてmarkdownを置いてあるのでわざわざファイル名にblogとかそういう文字を含めて検索などはしたくもなかった。

graphiqlのexplorerを眺めてたら`fileAbsolutePath` というのを見つけた。
これのfilterで正規表現の絞り込みができるregexがパラメータとして使えたのでこれでフォルダの階層を使って絞り込みができた。

```graphql
query BlogsQuery {
  allMdx(filter: {fileAbsolutePath: {regex: "/blogs/"}}) {
    nodes {
      frontmatter {
        title
      }
    }
  }
}
```

regex以外にも絞り込み条件があったけど今回のケースだとつかえなさそうだった。
- https://www.gatsbyjs.com/docs/graphql-reference/#complete-list-of-possible-operators

`/blogs/`みたいに/も条件に入れておくと/blogs~みたいなmarkdownの時に誤って引っかかることがないので良さそう。

また、他にもconfigでmarkdownが置いてある各階層にラベルをつけるやり方もあるみたいだけどこっちの方が簡単なので採用。

[^ver]: v3
[^deny]: 構造が違うものの結果をフィルタするのが嫌だったということ。
