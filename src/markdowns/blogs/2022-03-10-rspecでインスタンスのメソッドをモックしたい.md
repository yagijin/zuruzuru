---
title: Rspecでインスタンスのメソッドをモックしたい
date: 2022-03-10T22:32:06+09:00
description: Rspecで今日悩んだこと
url: /blog/2022-03-10-rspecでインスタンスのメソッドをモックしたい/
tags:
  - Rspec
  - Ruby
---	

Rubyのことブログに描くのはじめてだ。

```Ruby
Example.new.foo
```
このfooをmockしようとしたら、インスタンスのmockになるから毎回変わってmockできなくね？と思った。
単純にインスタンス自体をmockしてから、そこに対して新しくmockすれば良いことに気づいた。

```Ruby
mock = instance_double("Example")
allow(Example).to receive(:new).and_return(mock)
allow(mock).to receive(:foo).and_return(result)
```

書きがてら調べてると用語間違えてるかも、モックじゃなくてスタブというのかもしれない。

あと`allow`じゃなくて`allow_any_instance_of`っていうのもあるみたい。使えるなら特定のインスタンスに関心があるとき以外はこっちで良さそう。


これくらい気軽にブログ書いてこう。
